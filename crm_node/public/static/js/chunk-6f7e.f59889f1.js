(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6f7e"],{"3V1f":function(e,t,a){"use strict";a.d(t,"G",function(){return l}),a.d(t,"v",function(){return i}),a.d(t,"D",function(){return n}),a.d(t,"B",function(){return s}),a.d(t,"y",function(){return o}),a.d(t,"t",function(){return r}),a.d(t,"z",function(){return u}),a.d(t,"w",function(){return c}),a.d(t,"A",function(){return d}),a.d(t,"C",function(){return p}),a.d(t,"F",function(){return m}),a.d(t,"H",function(){return b}),a.d(t,"x",function(){return h}),a.d(t,"E",function(){return f}),a.d(t,"u",function(){return v}),a.d(t,"m",function(){return y}),a.d(t,"h",function(){return g}),a.d(t,"o",function(){return w}),a.d(t,"n",function(){return T}),a.d(t,"k",function(){return _}),a.d(t,"s",function(){return z}),a.d(t,"r",function(){return x}),a.d(t,"c",function(){return $}),a.d(t,"e",function(){return N}),a.d(t,"f",function(){return k}),a.d(t,"j",function(){return D}),a.d(t,"b",function(){return L}),a.d(t,"q",function(){return C}),a.d(t,"d",function(){return E}),a.d(t,"i",function(){return S}),a.d(t,"a",function(){return F}),a.d(t,"p",function(){return V}),a.d(t,"g",function(){return U}),a.d(t,"l",function(){return B});var l=[{display_name:"table"},{display_name:"excel"}],i=[{display_name:"yyyyMMdd"},{display_name:"yyyyMMdd Kaa"}],n=[{display_name:"Asia/Manila"},{display_name:"Asia/Jakarta"}],s=[{display_name:"Y"},{display_name:"N"}],o=[{display_name:"Y"},{display_name:"N"}],r=[{label:"Left",value:"left"},{label:"Right",value:"right"}],u=[{label:"Y",value:"Y"},{label:"N",value:""}],c=[{display_name:"excel"},{display_name:"csv"}],d=[{label:"Y",value:"Y"},{label:"N",value:"N"}],p=[{label:"By Month",value:"MONTH"},{label:"By Week",value:"WEEK"},{label:"By Day",value:"DAY"}],m=[{label:"January",value:"1"},{label:"February",value:"2"},{label:"March",value:"3"},{label:"April",value:"4"},{label:"May",value:"5"},{label:"June",value:"6"},{label:"July",value:"7"},{label:"August",value:"8"},{label:"September",value:"9"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}],b=[{label:"Monday",value:"2"},{label:"Tuesday",value:"3"},{label:"Wednesday",value:"4"},{label:"Thursday",value:"5"},{label:"Friday",value:"6"},{label:"Saturday",value:"7"},{label:"Sunday",value:"1"}];var h=function(){for(var e=[],t=0;t<24;t++)e[t]={value:t};return console.log(3,e),e}();var f=function(){for(var e=[],t=0;t<60;t++)e[t]={value:t,label:"0"+t};return e}(),v=[{label:"1st",value:"1"},{label:"2nd",value:"2"},{label:"3rd",value:"3"},{label:"4th",value:"4"},{label:"5th",value:"5"},{label:"6th",value:"6"},{label:"7th",value:"7"},{label:"8th",value:"8"},{label:"9th",value:"9"},{label:"10th",value:"10"},{label:"11th",value:"11"},{label:"12th",value:"12"},{label:"13th",value:"13"},{label:"14th",value:"14"},{label:"15th",value:"15"},{label:"16th",value:"16"},{label:"17th",value:"17"},{label:"18th",value:"18"},{label:"19th",value:"19"},{label:"20th",value:"20"},{label:"21st",value:"21"},{label:"22nd",value:"22"},{label:"23rd",value:"23"},{label:"24th",value:"24"},{label:"25th",value:"25"},{label:"26th",value:"26"},{label:"27th",value:"27"},{label:"28th",value:"28"},{label:"29th",value:"29"},{label:"30th",value:"30"},{label:"31th",value:"31"}],y="/webapi/biz",g="/webapi/schedulereport/biz",w="/webapi/biz/publish",T="/webapi/biz/stop",_="/webapi/schedulereport/biz/getPhaseId",z="/webapi/schedulereport/table/biz",x="/webapi/schedulereport/biz/table",$="/webapi/schedulereport/table/biz",N="/webapi/schedulereport/style",k="/webapi/schedulereport/mail",D="/webapi/schedulereport/table",L="/webapi/schedulereport/table/column",C="/webapi/schedulereport/table/column",E="/webapi/schedulereport/biz/table/html",S="/webapi/schedulereport/biz",F="/webapi/schedulereport/biz/mail",V="/webapi/schedulereport/biz/mail",U="/webapi/schedulereport/excel/biz",B="/webapi/schedulereport/biz/excel"},Ee2s:function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"d",function(){return u}),a.d(t,"a",function(){return c}),a.d(t,"c",function(){return d});var l=a("vDqi"),i=a.n(l),n=a("Qyje"),s=a.n(n),o={username:a("Q2AE").a.getters.email};function r(e,t){return i.a.get(e,{params:t,headers:o})}function u(e,t){return i.a.post(e,s.a.stringify(t),{headers:o})}function c(e,t){return i.a.delete(e+"/"+t,{headers:o})}function d(e,t){return i.a.get(e+"/"+t,{headers:o})}},ZySA:function(e,t,a){"use strict";var l=a("P2sY"),i=a.n(l),n=(a("jUE0"),{bind:function(e,t){e.addEventListener("click",function(a){var l=i()({},t.value),n=i()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},l),s=n.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var o=s.getBoundingClientRect(),r=s.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":((r=document.createElement("span")).className="waves-ripple",r.style.height=r.style.width=Math.max(o.width,o.height)+"px",s.appendChild(r)),n.type){case"center":r.style.top=o.height/2-r.offsetHeight/2+"px",r.style.left=o.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-o.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-o.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=n.color,r.className="waves-ripple z-active",!1}},!1)}}),s=function(e){e.directive("waves",n)};window.Vue&&(window.waves=n,Vue.use(s)),n.install=s;t.a=n},jUE0:function(e,t,a){},yzla:function(e,t,a){"use strict";a.r(t);var l=a("P2sY"),i=a.n(l),n=a("QbLZ"),s=a.n(n),o=a("L2JU"),r=a("Ee2s"),u=a("ZySA"),c=a("3V1f"),d=a("Yfch"),p={name:"EmailReport",directives:{waves:u.a},data:function(){return{tableKey:0,list:null,total:null,listLoading:!1,listQuery:{pageNo:1,pageSize:50,type:void 0,template:void 0},templateOptions:c.G,emailDateFormatOptions:c.v,mailTitleDateTimezoneOptions:c.D,phaseOptions:null,temp:{id:void 0,bizType:"",bizDesc:"",scheduleTimeExpr:"",mailTitle:"",mailTitleDateFormat:"",templateName:"table",isValid:0,mailTitleDateTimezone:"",isUpload:!1,scheduleTime:"",phaseId:""},dialogFormVisible:!1,modifiable:!1,publish_disabled:!0,dialogStatus:"",textMap:{edit:"Edit",create:"Create"},confirmVisible:!1,rules:{bizType:[{required:!0,message:"Biz Type is required",trigger:"blur"},{validator:function(e,t,a){Object(d.b)(t)?a(new Error('This param can not include "? . / ; [ ] % # "')):a()}}],scheduleTimeExpr:[{required:!0,message:"Schedule Time is required",trigger:"blur"}],mailTitle:[{required:!0,message:"Mail Title is required",trigger:"blur"}],templateName:[{required:!0,message:"Template  is required",trigger:"blur"}]}}},computed:s()({},Object(o.b)(["inputs"])),created:function(){this.getPhaseIdOptions()},mounted:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(r.b)(c.h,this.listQuery).then(function(t){e.listLoading=!1,1===t.data.code?(e.list=t.data.data.list,e.total=t.data.data.total,e.inputs.indexOf("emailReportPublish")>=0?e.publish_disabled=!1:e.publish_disabled=!0,e.listLoading=!1):e.$alert("Get List Error: "+t.data.msg)}).catch(function(t){e.listLoading=!1,e.$alert(t)})},getPhaseIdOptions:function(){var e=this;Object(r.b)(c.k).then(function(t){1===t.data.code?e.phaseOptions=t.data.data:e.$alert("Get PhaseId Error: "+t.data.msg)}).catch(function(t){e.$alert(t)})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNo=e,this.getList()},resetTemp:function(){this.temp={id:void 0,bizType:"",bizDesc:"",scheduleTimeExpr:"",mailTitle:"",mailTitleDateFormat:"",templateName:"table",isUpload:!1,phaseId:"",isValid:0,scheduleTime:"",mailTitleDateTimezone:""}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.modifiable=!1,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},createData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a=i()({},e.temp);delete a.id,a.isUpload="table"===e.temp.templateName.toLocaleLowerCase()?"":e.temp.isUpload?"Y":"N",console.log("isUpload",e.temp.isUpload),a.phaseId="Y"===a.isUpload?e.temp.phaseId:"",console.log(1111111,a),e.listLoading=!0,Object(r.d)(c.m,a).then(function(t){e.listLoading=!1,1===t.data.code?(e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.getList()):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3})}).catch(function(t){console.log(t),e.dialogFormVisible=!1,e.$alert(t)})}})},handleEdit:function(e){var t=this;this.copyData(this.temp,e),console.log(222,this.temp),this.dialogStatus="edit",this.dialogFormVisible=!0,this.modifiable=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},updateData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a=i()({},e.temp);a.isUpload="table"===e.temp.templateName.toLocaleLowerCase()?"":e.temp.isUpload?"Y":"N",console.log("isUpload",e.temp.isUpload),a.phaseId="Y"===a.isUpload?e.temp.phaseId:"",e.listLoading=!0,Object(r.d)(c.m,a).then(function(t){e.listLoading=!1,1===t.data.code?(e.dialogFormVisible=!1,e.getList(),e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})):e.$notify({title:"失败",message:t.data.msg,type:"error",duration:2e3})}).catch(function(t){e.dialogFormVisible=!1,e.$alert(t)})}})},handleView:function(e){"TABLE"===e.templateName.toLocaleUpperCase()?this.$router.push({path:"/emailReport/emailTableView",query:{bizType:e.bizType}}):"EXCEL"===e.templateName.toLocaleUpperCase()?(console.log("templateName",e.templateName),this.$router.push({path:"/emailReport/emailExcelView",query:{bizType:e.bizType}})):this.$message({type:"warning",message:"Please check your Biz List!",duration:2e3})},publishBiz:function(e){var t=this;this.$confirm("This action will send Email on schedule, are you sure?","Tips",{confirmButtonText:"Publish",cancelButtonText:"Cancle",type:"warning"}).then(function(){Object(r.d)(c.o+"/"+e.id,e.id).then(function(e){console.log("publishg........",e),1===e.data.code?(t.publish_disabled=!1,t.$notify({type:"success",message:" Published Successfully!",duration:2e3}),t.getList()):t.$notify({type:"error",message:e.data.msg,duration:2e3})}).catch(function(e){t.$alert(e),console.log(e)})}).catch(function(){})},pauseBiz:function(e){var t=this;this.$confirm("This action will stop to send Email, are you sure?","Tips",{confirmButtonText:"Pause",cancelButtonText:"Cancle",type:"warning"}).then(function(){Object(r.d)(c.n+"/"+e.id,e.id).then(function(e){console.log("publishg........",e),1===e.data.code?(t.publish_disabled=!1,t.$notify({type:"success",message:" Paused Successfully!",duration:2e3}),t.getList()):t.$notify({type:"error",message:e.data.msg,duration:2e3})}).catch(function(e){t.$alert(e),console.log(e)})}).catch(function(){})},handleDelete:function(e){var t=this;this.$confirm("This action will delete this Biz List, are you sure?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancle",type:"warning"}).then(function(){Object(r.a)(c.m,e.id).then(function(e){console.log(888,e),1===e.data.code?(t.getList(),t.$notify({type:"success",message:"Deleted Successfully!",duration:2e3})):t.$notify({type:"error",message:"Delete Unsuccessfully, please delete later",duration:2e3})}).catch(function(e){t.$alert(e),console.log(e)})}).catch(function(e){})},copyData:function(e,t){e.id=t.id,e.bizType=t.bizType,e.bizDesc=t.bizDesc,e.scheduleTime=t.scheduleTime,e.mailTitleDateFormat=t.mailTitleDateFormat,e.mailTitle=t.mailTitle,e.scheduleTimeExpr=t.scheduleTimeExpr,e.templateName=t.templateName,e.isValid=t.isValid,e.isUpload="Y"===t.isUpload,e.phaseId=t.phaseId,e.mailTitleDateTimezone=t.mailTitleDateTimezone}}},m=a("KHd+"),b=Object(m.a)(p,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container",staticStyle:{"text-align":"right"}},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("email.add")))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%","min-height":"1000px"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:e.$t("email.id"),prop:"id",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("email.type"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.bizType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("email.mailTitle"),"min-width":"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.mailTitle))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("email.scheduleTime"),width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.scheduleTimeExpr))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("email.templateName"),width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.templateName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("email.actions"),align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"actionButton",attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleView(t.row)}}},[e._v(e._s(e.$t("email.view")))]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"actionButton",attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v(e._s(e.$t("email.edit")))]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"actionButton",attrs:{type:"danger",size:"mini"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v(e._s(e.$t("email.delete")))]),e._v(" "),t.row.isValid?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"actionButton",attrs:{disabled:e.publish_disabled,type:t.row.isValid?"success":"primary",size:"mini"},on:{click:function(a){e.pauseBiz(t.row)}}},[e._v(e._s(e.$t("email.pause")))]):a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"actionButton",attrs:{disabled:e.publish_disabled,type:t.row.isValid?"success":"primary",size:"mini"},on:{click:function(a){e.publishBiz(t.row)}}},[e._v(e._s(e.$t("email.publish")))])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.listQuery.pageNo,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"80%","margin-left":"20px"},attrs:{disabled:e.listLoading,rules:e.rules,model:e.temp,"label-position":"right","label-width":"35%"}},[a("el-form-item",{attrs:{label:e.$t("email.type"),prop:"bizType"}},[a("el-input",{attrs:{disabled:e.modifiable},model:{value:e.temp.bizType,callback:function(t){e.$set(e.temp,"bizType",t)},expression:"temp.bizType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.desc")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.temp.bizDesc,callback:function(t){e.$set(e.temp,"bizDesc",t)},expression:"temp.bizDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.mailTitle"),prop:"mailTitle"}},[a("el-input",{model:{value:e.temp.mailTitle,callback:function(t){e.$set(e.temp,"mailTitle",t)},expression:"temp.mailTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.mailTitleDateFormat")}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},model:{value:e.temp.mailTitleDateFormat,callback:function(t){e.$set(e.temp,"mailTitleDateFormat",t)},expression:"temp.mailTitleDateFormat"}},e._l(e.emailDateFormatOptions,function(e){return a("el-option",{key:e.display_name,attrs:{label:e.display_name,value:e.display_name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.scheduleTime"),prop:"scheduleTimeExpr"}},[a("el-input",{attrs:{placeholder:"* * * * * ?"},model:{value:e.temp.scheduleTimeExpr,callback:function(t){e.$set(e.temp,"scheduleTimeExpr",t)},expression:"temp.scheduleTimeExpr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.templateName"),prop:"templateName"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{disabled:e.modifiable,prop:"templateName"},model:{value:e.temp.templateName,callback:function(t){e.$set(e.temp,"templateName",t)},expression:"temp.templateName"}},e._l(e.templateOptions,function(e){return a("el-option",{key:e.display_name,attrs:{label:e.display_name,value:e.display_name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:e.$t("email.mailTitleDateTimezone")}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{disabled:e.modifiable,prop:"mailTitleDateTimezone"},model:{value:e.temp.mailTitleDateTimezone,callback:function(t){e.$set(e.temp,"mailTitleDateTimezone",t)},expression:"temp.mailTitleDateTimezone"}},e._l(e.mailTitleDateTimezoneOptions,function(e){return a("el-option",{key:e.display_name,attrs:{label:e.display_name,value:e.display_name}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"excel"===e.temp.templateName.toLocaleLowerCase(),expression:"temp.templateName.toLocaleLowerCase() ==='excel'"}],attrs:{label:e.$t("email.isUpload")}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{disabled:!e.temp.isUpload},model:{value:e.temp.phaseId,callback:function(t){e.$set(e.temp,"phaseId",t)},expression:"temp.phaseId"}},e._l(e.phaseOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),e._v(" "),a("el-checkbox",{model:{value:e.temp.isUpload,callback:function(t){e.$set(e.temp,"isUpload",t)},expression:"temp.isUpload"}})],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("email.cancel")))]),e._v(" "),"create"==e.dialogStatus?a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.createData}},[e._v(e._s(e.$t("email.confirm")))]):a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.updateData}},[e._v(e._s(e.$t("email.confirm")))])],1)],1)],1)},[],!1,null,null,null);b.options.__file="EmailReport.vue";t.default=b.exports}}]);